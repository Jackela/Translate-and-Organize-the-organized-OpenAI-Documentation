# API 参考

curl [https://api.openai.com/v1/images/variations](https://api.openai.com/v1/images/variations) \
-H "Authorization: Bearer $OPENAI_API_KEY" \
-F image="@otter.png" \
-F n=2 \
-F size="1024x1024"

# **介绍**

可以通过任何语言的 HTTP 请求与 API 交互，详情请参考[库](%E5%BA%93%20a470b72321a346ec8811e8509e45d251.md)

## **身份验证**

<aside>
📖 **API key：**应用程序接口密钥，API key 是一种用于身份验证的密钥，通常用于控制对 API（应用程序接口）的访问。它是由 API 提供者提供的一种令牌，可标识开发者或用户身份，以限制或授权对 API 的访问。开发者需要将其嵌入到代码中的 API 调用中，以进行身份验证。API 提供者可以根据 key 限制每个用户的请求速率，或根据不同的 key 对 API 进行不同的授权。

**API： Application Programming Interface**，应用程序编程接口，在特定的软件环境下，不同的软件组件之间互相交互的一种方式，是一组预定义的协议、规则和工具集合，用于构建软件应用程序。

**Account quota：**账户配额，在云平台或其他计算资源提供商中，每个用户或账户被分配一定的计算资源或使用限制。这些资源包括存储空间、CPU核心数量、网络带宽等，以控制资源使用和满足需求。这些配额通常可以通过登录账户并查看账户信息来管理。

</aside>

<aside>
💡 OpenAI会自动回收已泄露的api key，如果发现出现“empty message” 或 “invalid API key”相关问题，请检查**[API 密钥](https://platform.openai.com/account/api-keys)** 页面或登录账号邮箱查询Key是否被判定为泄露（leak）

在以下情况下，API密钥将被视为“泄漏”：

> 将API密钥提交到公共或私人源代码存储库中
系统或应用程序中的数据泄漏
未经授权访问您的帐户配额
> 
</aside>

生产请求必须通过后端服务器，API 密钥可以从环境变量或密钥管理服务中安全地加载。

### 加载API key

python：

```python
import os
import openai
openai.organization = "org-pUNaTZzDWO5HyEawU3Nltlp9"
openai.api_key = os.getenv("OPENAI_API_KEY")
```

Node.js:

```jsx
import { Configuration, OpenAIApi } from "openai";
const configuration = new Configuration({
    organization: "org-pUNaTZzDWO5HyEawU3Nltlp9",
    apiKey: process.env.OPENAI_API_KEY,
});
```

所有 API 请求都应在`Authorization`HTTP 标头中包含 API 密钥，如下所示：

`Authorization: Bearer OPENAI_API_KEY`

## **请求组织**

<aside>
📖 Organization：组织，与您的OpenAI账户相关联的实体。在登录后，您可以在组织设置中找到您的组织名称和ID。组织名称是显示在用户界面中的标签，而组织ID是可用于API请求的唯一标识符。

</aside>

对于属于多个组织的用户，您可以传递一个标头来指定用于 API 请求的组织。使用这些 API 请求的用量将计入指定组织的订阅配额。

示例 curl 命令：

```
curl <https://api.openai.com/v1/models> \\\\
  -H "Authorization: Bearer $OPENAI_API_KEY" \\\\
  -H "OpenAI-Organization: org-pUNaTZzDWO5HyEawU3Nltlp9"
```

使用 **`openai`** Python 包的示例：

```
import os
import openai
openai.organization = "org-pUNaTZzDWO5HyEawU3Nltlp9"
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Model.list()
```

使用 **`openai`** Node.js 包的示例：

```
import { Configuration, OpenAIApi } from "openai";
const configuration = new Configuration({
    organization: "org-pUNaTZzDWO5HyEawU3Nltlp9",
    apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.listEngines();
```

组织 ID 可以在 **[组织设置](https://platform.openai.com/account/org-settings)** 页面找到。

## **进行请求**

将以下命令粘贴到终端中，以运行一个API请求。请确保将`$OPENAI_API_KEY`替换为API密钥。

```
curl <https://api.openai.com/v1/chat/completions> \\\\
  -H "Content-Type: application/json" \\\\
  -H "Authorization: Bearer $OPENAI_API_KEY" \\\\
  -d '{
     "model": "gpt-3.5-turbo",
     "messages": [{"role": "user", "content": "Say this is a test!"}],
     "temperature": 0.7
   }'

```

此请求查询`gpt-3.5-turbo`模型，以完成以提示“*Say this is a test*”开头的文本。

<aside>
💡 大多数时候api回复为Dict[]，部分时候为List[Dict[]]，请根据实际状况调整代码。
大多是时候api回复内容格式为Json

</aside>

应该收到一个类似以下的响应：

```json
{
   "id":"chatcmpl-abc123",
   "object":"chat.completion",
   "created":1677858242,
   "model":"gpt-3.5-turbo-0301",
   "usage":{
      "prompt_tokens":13,
      "completion_tokens":7,
      "total_tokens":20
   },
   "choices":[
      {
         "message":{
            "role":"assistant",
            "content":"\\\\n\\\\nThis is a test!"
         },
         "finish_reason":"stop",
         "index":0
      }
   ]
}

```

现在，第一个聊天完成。可以看到`finish_reason`是`stop`**，**这意味着API返回了模型生成的完整完成。

在上面的请求中，只生成了一条消息（默认状态n=1），**可以设置`n`参数以生成多个消息选项。**

### 参数

### 示例请求

### 示例响应

<aside>
🔑 测试/试用范例前，请务必记得将`$OPENAI_API_KEY`替换为自己的API 密钥

访问 **[API 密钥](https://platform.openai.com/account/api-keys)** 页面以检索在请求中使用的 API 密钥。

</aside>

<aside>
📖 **Required：**必选

**Optional：**可选

</aside>

# [模型](https://platform.openai.com/docs/api-reference/models)

参考[模型](%E6%A8%A1%E5%9E%8B%20d5054199951a46c8b18dbd2073c3fa78.md)文档了解可用模型及其之间的区别。

## **列出模型**

列出目前可用的模型，并提供每个模型的基本信息，例如所有者和可用性。

```markdown
GET https://api.openai.com/v1/models
```

### 参数

### 示例请求

curl

```markdown
curl [https://api.openai.com/v1/models](https://api.openai.com/v1/models) \
-H "Authorization: Bearer $OPENAI_API_KEY"
```

python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Model.list()
```

node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.listModels();
```

### 示例响应

```json
{
  "data": [
    {
      "id": "model-id-0",
      "object": "model",
      "owned_by": "organization-owner",
      "permission": [...]
    },
    {
      "id": "model-id-1",
      "object": "model",
      "owned_by": "organization-owner",
      "permission": [...]
    },
    {
      "id": "model-id-2",
      "object": "model",
      "owned_by": "openai",
      "permission": [...]
    },
  ],
  "object": "list"
}
```

## **获取模型**

```markdown
GET [https://api.openai.com/v1/models/{model}](https://api.openai.com/v1/models/%7Bmodel%7D)
```

检索模型实例，提供有关模型的基本信息，例如所有者和权限设置。

### 参数

```markdown
model: string Required
用于此请求的模型的ID
```

### 示例请求

<aside>
🤖 以”ada”为例，可自由替换现有模型，详细名称请查阅[模型](%E6%A8%A1%E5%9E%8B%20d5054199951a46c8b18dbd2073c3fa78.md)文档

</aside>

### **curl**

```markdown
curl https://api.openai.com/v1/models/ada \
  -H "Authorization: Bearer $OPENAI_API_KEY"
```

### **python**

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Model.retrieve("ada")
```

### **node.js**

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.retrieveModel("ada");
```

### 示例响应

```json
{
  "id": "ada",
  "object": "model",
  "owned_by": "openai",
  "permission": [...]
}
```

<aside>
🤖 Completions和Chat的区别在于用途和实现方式不同。Completions用于生成文本完成，提供了强大的模型接口；而Chat是一种使用聊天式格式的API，更具有交互性，并可用于交互式任务。
Chat是比Completions API更新的API，Chat API使用不同（更新）的模型：“gpt-3.5， gpt-4”。
详细参见[模型](%E6%A8%A1%E5%9E%8B%20d5054199951a46c8b18dbd2073c3fa78.md)

</aside>

<aside>
📖 **Completion：**文本补全，自动文本生成或语言模型的 Completion 功能，即输入一部分文本，然后使用该模型来生成余下部分的语段。

**Temperature：**温度，控制自动文本生成的参数。温度越高，生成的文本就越不确定、更有创造性和多样性，但也更难理解。温度设置得越低，生成的文本就越确定和精确，但可能缺乏创造性和多样性。

**Nucleus sampling：**核心采样，一种在自然语言处理中使用的文本生成技术，从预测的可能性分布中选择概率总和最接近指定阈值的最小集，这个集合中的所有选项成为可选候选项。随机抽样输出一项，确保多样性，同时排除可能性非常低的单词和组合。

**Stream：**流式传输，使用流式传输机制，可以实时将API响应数据推送给客户端，无需等待整个响应数据生成。Stream机制提高了数据传输效率和响应速度，适合处理大规模任务和提高API性能。

</aside>

# [文本补全](https://platform.openai.com/docs/api-reference/completions)

给定一个提示，模型将返回一个或多个预测的完成，并可以返回每个位置上备选标记的概率。

## 创建补全

为提供的提示和参数创建完成。

```markdown
POST [https://api.openai.com/v1/completions](https://api.openai.com/v1/completions)
```

### 参数

```markdown
model: string Required
要使用的模型ID。
```

可以使用[列出模型](https://platform.openai.com/docs/api-reference/models/list)API查看所有可用模型，或查看模型文档获取更多细节。

```markdown
prompt: string | array Optional Defaults: <|endoftext|>
用于生成完成提示的提示，以字符串、字符串数组、令牌数组或令牌数组的形式编码。
```

`<|endoftext|>` 该符号是在模型训练期间的文档分隔符。

因此，如果未指定提示，则模型将生成似乎是从新文档开头开始的。

```markdown
suffix: string Optional Defaults: null
插入文本完成后的后缀。
```

```markdown
max_tokens: integer Optional Defaults: 16
在完成中生成的最大token数。
```

您的提示文本字符数以及 **`max_tokens`** 参数的总和不能超过模型所能接受的上下文长度。参考OpenAI提供的[Cookbook](https://github.com/openai/openai-cookbook/tree/main)中的 **[Python 代码示例](https://github.com/openai/openai-cookbook/blob/main/examples/How_to_count_tokens_with_tiktoken.ipynb)** 计算token数量。

```markdown
temperature: number Optional Defaults: 1 
选择0到2之间的采样温度。较高的温度（如0.8）会使结果更随机，较低的温度（如0.2）会使结果更集中和确定。
```

<aside>
⚙ 通常建议更改`temperature`或`top_p`，但不要同时更改两者。以下是可用的参数

</aside>

```markdown
top_p: number Optional Defaults: 1、
```

使用称为 nucleus sampling 的替代温度采样，模型会考虑具有 top_p 概率质量的token的结果。所以 0.1 表示仅考虑组成前 10% 概率质量的token。

```
n: integer Optional Defaults: 1
为每个提示生成的完成数。
```

```
stream: boolean Optional Defaults: false
是否返回部分进度。
```

如果设置为True，API调用可以实时返回已处理的标记，以数据流的形式发送数据。当处理的标记可用时，将发送一个数据流消息，将标记作为数据发送。处理完成时，将发送一个"data: [DONE]"的终止消息来标识流的结束。

```
logprobs: integer Optional Defaults: null
在最可能的标记上包括对数概率以及选择的标记。
```

例如，如果 logprobs 为 5，则 API 将返回最有可能的 5 个标记的列表。API 将始终返回所选令牌的对数概率，因此响应中最多可能有 logprobs+1 个元素。

```
echo: boolean Optional Defaults: false
除了完成之外还回显提示。
```

```
stop: string | array Optional Defaults: null
API 将在此处停止进一步生成的tokens。
```

最多可生成 4 个序列。返回的文本不包含停止序列。

```
presence_penalty: number Optional Defaults: 0
介于 -20 和 20 之间的数字。
```

为增加模型对新话题的讨论可能性，需要检查惩罚新令牌是否出现在迄今为止的文本中。

```
best_of: integer Optional Defaults: 1
在服务器端生成 best_of 完成并返回“最佳”完成，即每个标记的最高对数概率。
```

结果无法流式传输。

```
logit_bias: map Optional Defaults: null
修改出现在完成中的指定标记的可能性。
```

```
user: string Optional
表示您的最终用户的唯一标识符。
```

可以帮助 OpenAI 监视和检测滥用。

### 示例请求

### curl

```
curl <https://api.openai.com/v1/completions> \\
-H "Content-Type: application/json" \\
-H "Authorization: Bearer $OPENAI_API_KEY" \\
-d '{
"model": "text-davinci-003",
"prompt": "Say this is a test",
"max_tokens": 7,
"temperature": 0
}'

```

### python

```
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Completion.create(
model="text-davinci-003",
prompt="Say this is a test",
max_tokens=7,
temperature=0
)

```

### node.js

```
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.complete({
  engine: "text-davinci-003",
  prompt: "Say this is a test",
  maxTokens: 7,
  temperature: 0,
});

```

### 示例响应

```json
{
"id": "cmpl-uqkvlQyYK7bGYrRHQ0eXlWi7",
"object": "text_completion",
"created": 1589478378,
"model": "text-davinci-003",
"choices": [
{
"text": "\n\nThis is indeed a test",
"index": 0,
"logprobs": null,
"finish_reason": "length"
}
],
"usage": {
"prompt_tokens": 5,
"completion_tokens": 7,
"total_tokens": 12
}
}
```

# **[聊天](https://platform.openai.com/docs/api-reference/chat)**

给定一组描述对话的消息列表，模型将返回一个响应。

## 创建聊天

```markdown
POST [https://api.openai.com/v1/chat/completions](https://api.openai.com/v1/chat/completions)
```

### 参数

```markdown
model: string Required
要使用的模型ID。
```

```markdown
messages: array Required
已进行的对话的消息列表。

	role: string Required
	这条消息的作者角色。可选： system、user 或 assistant。
	
	content: string Required
	消息内容。
	
	name: string Optional
	这条消息的作者姓名。可以包含a-z、A-Z、0-9和下划线，最大长度为64个字符。
```

```markdown
temperature: number Optional Defaults: 1 
选择0到2之间的采样温度。
```

较高的温度（如0.8）会使结果更随机，较低的温度（如0.2）会使结果更集中和确定。

<aside>
⚙ 通常建议更改`temperature`或`top_p`，但不要同时更改两者。以下是可用的参数

</aside>

```markdown
top_p: number Optional Defaults: 1
```

使用称为 nucleus sampling 的替代温度采样，模型会考虑具有 top_p 概率质量的token的结果。所以 0.1 表示仅考虑组成前 10% 概率质量的令牌。

```
n: integer Optional Defaults: 1
为每个提示生成的完成数。
```

```
stream: boolean Optional Defaults: false
是否返回部分进度。
```

如果设置为True，API调用可以实时返回已处理的标记，以数据流的形式发送数据。当处理的标记可用时，将发送一个数据流消息，将标记作为数据发送。处理完成时，将发送一个"data: [DONE]"的终止消息来标识流的结束。

```
logprobs: integer Optional Defaults: null
在最可能的标记上包括对数概率以及选择的标记。
```

例如，如果 logprobs 为 5，则 API 将返回最有可能的 5 个标记的列表。API 将始终返回所选令牌的对数概率，因此响应中最多可能有 logprobs+1 个元素。

```
echo: boolean Optional Defaults: false
除了完成之外还回显提示。
```

```
stop: string | array Optional Defaults: null
API 将在此处停止进一步生成的tokens。
```

最多可生成 4 个序列。返回的文本不包含停止序列。

<aside>
📖 **Frequency and presence penalties**

频率和存在惩罚可以用来减少重复的标记序列的采样概率。它们通过直接修改逻辑回归（未归一化的对数概率）与加性贡献相结合来工作。

`mu[j] -> mu[j] - c[j] * alpha_frequency - float(c[j] > 0) * alpha_presence`

其中：

- **`mu[j]`** 是第j个token的逻辑回归
- **`c[j]`** 是在当前位置之前对该token进行采样的频率
- **`float(c[j] > 0)`** 是1，如果**`c[j] > 0`*，否则为0
- **`alpha_frequency`** 是频率惩罚系数
- **`alpha_presence`** 是存在惩罚系数

正如我们所看到的，存在惩罚是一次性的加性贡献，适用于已经被采样至少一次的所有标记，而频率惩罚是与已经被采样的特定标记的频率成比例的贡献。

如果旨在仅略微减少重复采样，则惩罚系数的合理值约为0.1到1。如果旨在强烈抑制重复，则可以将系数增加到2，但这可能会明显降低样本的质量。负值可用于增加重复的可能性。

</aside>

```
presence_penalty: number Optional Defaults: 0
介于 -2.0 和 2.0 之间的数字。
```

正值会根据新标记是否出现在已有文本中对新标记进行惩罚，从而提高模型谈论新话题的可能性。

```
frequency_penalty: number Optional Defaults: 0
介于 -2.0 和 2.0 之间的数字。
```

正值会根据新标记在已有文本中的频率对新标记进行惩罚，从而降低模型完全重复相同语句的可能性。

```
best_of: integer Optional Defaults: 1
在服务器端生成 best_of 完成并返回“最佳”完成，即每个标记的最高对数概率。
```

结果无法流式传输。

```
logit_bias: map Optional Defaults: null
修改出现在完成中的指定标记的可能性。
```

```
user: string Optional
表示您的最终用户的唯一标识符。
```

可以帮助 OpenAI 监视和检测滥用。

### 示例请求

### curl

```
curl <https://api.openai.com/v1/chat/completions> \\
-H "Content-Type: application/json" \\
-H "Authorization: Bearer $OPENAI_API_KEY" \\
-d '{
"model": "gpt-3.5-turbo",
"messages": [{"role": "user", "content": "Hello!"}]
}'

```

### python

```
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")

completion = openai.ChatCompletion.create(
model="gpt-3.5-turbo",
messages=[
{"role": "user", "content": "Hello!"}
]
)

print(completion.choices[0].message)

```

### node.js

```
const { Configuration, OpenAIApi } = require("openai");

const configuration = new Configuration({
apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);

const completion = await openai.createChatCompletion({
model: "gpt-3.5-turbo",
messages: [{role: "user", content: "Hello world"}],
});
console.log(completion.data.choices[0].message);

```

### 示例响应

```json
{
"id": "chatcmpl-123",
"object": "chat.completion",
"created": 1677652288,
"choices": [{
"index": 0,
"message": {
"role": "assistant",
"content": "\n\nHello there, how may I assist you today?",
},
"finish_reason": "stop"
}],
"usage": {
"prompt_tokens": 9,
"completion_tokens": 12,
"total_tokens": 21
}
}
```

# [编辑](https://platform.openai.com/docs/api-reference/edits)

## 创建编辑

```markdown
POST https://api.openai.com/v1/edits
```

为提供的输入、指令和参数创建新的编辑。

### 参数

```markdown
model: string Required
要使用的模型ID。
```

```markdown
input string Optional Defaults: ''
用作编辑起点的输入文本。
```

```markdown
instruction: string Required
告诉模型如何编辑提示的指令。
```

```markdown
n: integer Optional Defaults: 1
为输入和说明文本生成多少次编辑
```

```markdown
temperature: number Optional Defaults: 1 
选择0到2之间的采样温度。较高的温度（如0.8）会使结果更随机，较低的温度（如0.2）会使结果更集中和确定。
```

<aside>
⚙ 通常建议更改`temperature`或`top_p`，但不要同时更改两者。以下是可用的参数

</aside>

```markdown
top_p: number Optional Defaults: 1
```

使用称为 nucleus sampling 的替代温度采样，模型会考虑具有 top_p 概率质量的token的结果。所以 0.1 表示仅考虑组成前 10% 概率质量的令牌。

### 示例请求

### curl

```markdown
curl [https://api.openai.com/v1/edits](https://api.openai.com/v1/edits) \
-H "Content-Type: application/json" \
-H "Authorization: Bearer $OPENAI_API_KEY" \
-d '{
"model": "text-davinci-edit-001",
"input": "What day of the wek is it?",
"instruction": "Fix the spelling mistakes"
}'
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Edit.create(
model="text-davinci-edit-001",
input="What day of the wek is it?",
instruction="Fix the spelling mistakes"
)
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.createEdit({
model: "text-davinci-edit-001",
input: "What day of the wek is it?",
instruction: "Fix the spelling mistakes",
});
```

### 示例响应

```json
{
"object": "edit",
"created": 1589478378,
"choices": [
{
"text": "What day of the week is it?",
"index": 0,
}
],
"usage": {
"prompt_tokens": 25,
"completion_tokens": 32,
"total_tokens": 57
}
}
```

# [图像](https://platform.openai.com/docs/api-reference/images)

模型会根据提示和/或输入的图片生成一张新的图片。

## 创建图片

```markdown
POST https://api.openai.com/v1/images/generations
```

### 参数

```markdown
prompt: string Required
所需的图像的文本描述。最大长度为1000个字符。
```

```markdown
n: string Optional Defaults: 1
要生成的图像数量。
```

必须在1和10之间。

```markdown
size: string Optional
生成的图像的尺寸。
```

必须为256x256、512x512或1024x1024中的一个。

```json
response_format: string Optional Defaults: url
生成的图像返回的格式。
```

必须为url或b64_json中的一个。

```
user: string Optional
表示您的最终用户的唯一标识符。
```

可以帮助 OpenAI 监视和检测滥用。

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/images/generations \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -d '{
    "prompt": "A cute baby sea otter",
    "n": 2,
    "size": "1024x1024"
  }'
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Image.create(
  prompt="A cute baby sea otter",
  n=2,
  size="1024x1024"
)
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.createImage({
  prompt: "A cute baby sea otter",
  n: 2,
  size: "1024x1024",
});
```

### 示例响应

```json
{
  "created": 1589478378,
  "data": [
    {
      "url": "https://..."
    },
    {
      "url": "https://..."
    }
  ]
}
```

## 创建图像编辑

### 参数

```markdown
image: string Required
要编辑的图像。
```

必须是有效的PNG文件，小于4MB，且为正方形。如果未提供掩码，则图像必须具有透明度，该透明度将用作掩码。

```markdown
mask: string Optional
附加的图像，完全透明的区域（例如透明度为零的区域）指示应在其中编辑图像。
```

必须是有效的PNG文件，小于4MB，并具有与图像相同的尺寸。

```markdown
prompt: string Required
所需的图像的文本描述。最大长度为1000个字符。
```

```markdown
n: string Optional Defaults: 1
要生成的图像数量。
```

必须在1和10之间。

```markdown
size: string Optional
生成的图像的尺寸。
```

必须为256x256、512x512或1024x1024中的一个。

```json
response_format: string Optional Defaults: url
生成的图像返回的格式。
```

必须为url或b64_json中的一个。

```
user: string Optional
表示您的最终用户的唯一标识符。
```

可以帮助 OpenAI 监视和检测滥用。

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/images/edits \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -F image="@otter.png" \
  -F mask="@mask.png" \
  -F prompt="A cute baby sea otter wearing a beret" \
  -F n=2 \
  -F size="1024x1024"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Image.create_edit(
  image=open("otter.png", "rb"),
  mask=open("mask.png", "rb"),
  prompt="A cute baby sea otter wearing a beret",
  n=2,
  size="1024x1024"
)
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.createImageEdit(
  fs.createReadStream("otter.png"),
  fs.createReadStream("mask.png"),
  "A cute baby sea otter wearing a beret",
  2,
  "1024x1024"
);
```

### 示例响应

```json
{
  "created": 1589478378,
  "data": [
    {
      "url": "https://..."
    },
    {
      "url": "https://..."
    }
  ]
}
```

## 创建图像变种

### 参数

```markdown
image: string Required
要编辑的图像。
```

必须是有效的PNG文件，小于4MB，且为正方形。如果未提供掩码，则图像必须具有透明度，该透明度将用作掩码。

```markdown
prompt: string Required
所需的图像的文本描述。最大长度为1000个字符。
```

```markdown
n: string Optional Defaults: 1
要生成的图像数量。
```

必须在1和10之间。

```markdown
size: string Optional
生成的图像的尺寸。
```

必须为256x256、512x512或1024x1024中的一个。

```json
response_format: string Optional Defaults: url
生成的图像返回的格式。
```

必须为url或b64_json中的一个。

```
user: string Optional
表示您的最终用户的唯一标识符。
```

可以帮助 OpenAI 监视和检测滥用。

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/images/variations \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -F image="@otter.png" \
  -F n=2 \
  -F size="1024x1024"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Image.create_variation(
  image=open("otter.png", "rb"),
  n=2,
  size="1024x1024"
)
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.createImageVariation(
  fs.createReadStream("otter.png"),
  2,
  "1024x1024"
);
```

### 示例响应

```json
{
  "created": 1589478378,
  "data": [
    {
      "url": "https://..."
    },
    {
      "url": "https://..."
    }
  ]
}
```

# [嵌入](https://platform.openai.com/docs/api-reference/embeddings)

获取给定输入的向量表示，可轻松地被机器学习模型和算法使用。

## 创建嵌入

```markdown
POST https://api.openai.com/v1/embeddings
```

### 参数

```markdown
model: string Required
要使用的模型ID
```

```markdown
input: string | array Required
要嵌入的输入文本，编码为字符串或tokens数组。
```

为在单个请求中嵌入多个输入，需传递字符串或token数组的数组（an array of strings or array of token arrays.）。每个输入的token数不能超过模型的最大token令牌数（text-embedding-ada-002的最大输入token数为8191个）。

```
user: string Optional
表示您的最终用户的唯一标识符。
```

可以帮助 OpenAI 监视和检测滥用。

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/embeddings \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "input": "The food was delicious and the waiter...",
    "model": "text-embedding-ada-002"
  }'
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Embedding.create(
  model="text-embedding-ada-002",
  input="The food was delicious and the waiter..."
)
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.createEmbedding({
  model: "text-embedding-ada-002",
  input: "The food was delicious and the waiter...",
});
```

### 示例响应

```json
{
  "object": "list",
  "data": [
    {
      "object": "embedding",
      "embedding": [
        0.0023064255,
        -0.009327292,
        .... (1536 floats total for ada-002)
        -0.0028842222,
      ],
      "index": 0
    }
  ],
  "model": "text-embedding-ada-002",
  "usage": {
    "prompt_tokens": 8,
    "total_tokens": 8
  }
}
```

# [音频](https://platform.openai.com/docs/api-reference/audio)

将音频转换为文本。

## 创建转录

```markdown
POST https://api.openai.com/v1/audio/transcriptions
```

### 参数

```markdown
file: file Required
需要转录的音频文件对象（不是文件名）。
```

支持以下格式之一：mp3、mp4、mpeg、mpga、m4a、wav 或 webm。

<aside>
⚠️ .m4a 以在文件结尾处（而非开头）放置moov原子而声名狼藉。请验证您的文件是否符合此情况。
部分.m4a文件可能不被支持/正确识别

</aside>

```markdown
model: string Required
要使用的模型ID
```

```markdown
prompt: string Optional
这是一个可选文本，可以引导模型的风格或继续上一个音频片段。
```

这个提示应该匹配音频的语言。

```
response_format: string Optional Defaults: json
生成的音频返回的格式。
```

转录输出的格式可选项包括：json、text、srt、verbose_json、vtt。

```markdown
temperature: number Optional Defaults: 1 
选择0到2之间的采样温度。
```

较高的温度（如0.8）会使结果更随机，较低的温度（如0.2）会使结果更集中和确定。

```markdown
language: string Optional
输入音频的语言。
```

使用 [ISO-639-1](https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes) 格式指定输入语言将提高转录的准确率和响应时间。

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/audio/transcriptions \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -H "Content-Type: multipart/form-data" \
  -F file="@/path/to/file/audio.mp3" \
  -F model="whisper-1"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
audio_file = open("audio.mp3", "rb")
transcript = openai.Audio.transcribe("whisper-1", audio_file
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const resp = await openai.createTranscription(
  fs.createReadStream("audio.mp3"),
  "whisper-1"
);
```

### 示例响应

```json
{
  "text": "Imagine the wildest idea that you've ever had, and you're curious about how it might scale to something that's a 100, a 1,000 times bigger. This is a place where you can get to do that."
}
```

## 创建翻译

<aside>
⚠️ 仅支持翻译为英文，且中文转英文不可用。（2023.06.13）

</aside>

```markdown
POST https://api.openai.com/v1/audio/translations
```

### 参数

```markdown
file: file Required
需要转录的音频文件对象（不是文件名）。
```

支持以下格式之一：mp3、mp4、mpeg、mpga、m4a、wav 或 webm。

<aside>
⚠️ .m4a 以在文件结尾处（而非开头）放置moov原子而声名狼藉。请验证您的文件是否符合此情况。
部分.m4a文件可能不被支持/正确识别

</aside>

```markdown
model: string Required
要使用的模型ID
```

```markdown
prompt: string Optional
这是一个可选文本，可以引导模型的风格或继续上一个音频片段。
```

这个提示应该匹配音频的语言。

```
response_format: string Optional Defaults: json
生成的音频返回的格式。
```

转录输出的格式可选项包括：json、text、srt、verbose_json、vtt。

```markdown
temperature: number Optional Defaults: 1 
选择0到2之间的采样温度。
```

较高的温度（如0.8）会使结果更随机，较低的温度（如0.2）会使结果更集中和确定。

<aside>
⚠️ language: string Optional
输入音频的语言。
目前版本不支持该参数（2023.06.13）

</aside>

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/audio/translations \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -H "Content-Type: multipart/form-data" \
  -F file="@/path/to/file/german.m4a" \
  -F model="whisper-1"
```

### python

```python
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const resp = await openai.createTranslation(
  fs.createReadStream("audio.mp3"),
  "whisper-1"
);
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const resp = await openai.createTranslation(
  fs.createReadStream("audio.mp3"),
  "whisper-1"
);
```

### 示例响应

```json
{
  "text": "Hello, my name is Wolfgang and I come from Germany. Where are you heading today?"
}
```

# [文件](https://platform.openai.com/docs/api-reference/files)

文件用于上传文档，可与 [微调](%E5%BE%AE%E8%B0%83%201e63ab4b20b14f5fbf01c29815bd39a4.md) 等功能一起使用。

## 列出文件

```markdown
GET https://api.openai.com/v1/files
```

### 参数

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/files \
  -H "Authorization: Bearer $OPENAI_API_KEY"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.File.list()
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.listFiles();
```

### 示例响应

```json
{
  "data": [
    {
      "id": "file-ccdDZrC3iZVNiQVeEA6Z66wf",
      "object": "file",
      "bytes": 175,
      "created_at": 1613677385,
      "filename": "train.jsonl",
      "purpose": "search"
    },
    {
      "id": "file-XjGxS3KTG0uNmNOK362iJua3",
      "object": "file",
      "bytes": 140,
      "created_at": 1613779121,
      "filename": "puppy.jsonl",
      "purpose": "search"
    }
  ],
  "object": "list"
}
```

## 上传文件

上传包含要在各种端点/功能之间使用的文档的文件。

当前（2023-06-13），一个组织上传的所有文件的大小最多可以达到 1 GB。

```markdown
POST https://api.openai.com/v1/files
```

### 参数

<aside>
⚠️ 请使用[JSON Lines](JSON%20Lines%206a01e35bf82b467eb3246d9d888e767d.md) 文件

</aside>

```json
file: string Required
要上传的 JSON Lines 文件的名称。
```

如果目的设置为“Fine-tuning”，则每一行是一个 JSON 记录，其中包含“prompt”和“completion”字段，表示您的训练示例。

```json
purpose: string Required
上传文档的预期目的。
```

使用“Fine-tune”作为传入参数进行微调。OpenAI将能验证上传文件的格式。

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/files \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -F purpose="fine-tune" \
  -F file="@mydata.jsonl"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.File.create(
  file=open("mydata.jsonl", "rb"),
  purpose='fine-tune'
)
```

### node.js

```jsx
const fs = require("fs");
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.createFile(
  fs.createReadStream("mydata.jsonl"),
  "fine-tune"
);
```

### 示例响应

```json
{
  "data": [
    {
      "id": "file-ccdDZrC3iZVNiQVeEA6Z66wf",
      "object": "file",
      "bytes": 175,
      "created_at": 1613677385,
      "filename": "train.jsonl",
      "purpose": "search"
    },
    {
      "id": "file-XjGxS3KTG0uNmNOK362iJua3",
      "object": "file",
      "bytes": 140,
      "created_at": 1613779121,
      "filename": "puppy.jsonl",
      "purpose": "search"
    }
  ],
  "object": "list"
}
```

## 删除文件

```markdown
DELETE https://api.openai.com/v1/files/{file_id}
```

### 参数

```json
file_id: string Required
用于此请求的文件 ID。
```

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/files/file-XjGxS3KTG0uNmNOK362iJua3 \
  -X DELETE \
  -H "Authorization: Bearer $OPENAI_API_KEY"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.File.delete("file-XjGxS3KTG0uNmNOK362iJua3")
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.deleteFile("file-XjGxS3KTG0uNmNOK362iJua3");
```

### 示例响应

```json
{
  "id": "file-XjGxS3KTG0uNmNOK362iJua3",
  "object": "file",
  "deleted": true
}
```

## 检索文件

```markdown
GET https://api.openai.com/v1/files/{file_id}
```

### 参数

```json
file_id: string Required
用于此请求的文件 ID。
```

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/files/file-XjGxS3KTG0uNmNOK362iJua3 \
  -H "Authorization: Bearer $OPENAI_API_KEY"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.File.retrieve("file-XjGxS3KTG0uNmNOK362iJua3")
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.retrieveFile("file-XjGxS3KTG0uNmNOK362iJua3");
```

### 示例响应

```json
{
  "id": "file-XjGxS3KTG0uNmNOK362iJua3",
  "object": "file",
  "bytes": 140,
  "created_at": 1613779657,
  "filename": "mydata.jsonl",
  "purpose": "fine-tune"
}
```

## 检索文件内容

```markdown
GET https://api.openai.com/v1/files/{file_id}/content
```

### 参数

```json
file_id: string Required
用于此请求的文件 ID。
```

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/files/file-XjGxS3KTG0uNmNOK362iJua3/content \
  -H "Authorization: Bearer $OPENAI_API_KEY" > file.jsonl
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
content = openai.File.download("file-XjGxS3KTG0uNmNOK362iJua3")
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.downloadFile("file-XjGxS3KTG0uNmNOK362iJua3");
```

### 示例响应

# [微调](https://platform.openai.com/docs/api-reference/fine-tunes)

管理微调作业以针对特定的训练数据优化模型是机器学习中的一种强大技术。

<aside>
⚠️ 微调相关的名词已在[微调](../OpenAI%E7%9A%84API%E7%9B%B8%E5%85%B3%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99%2050383492c7174b7d9cfb40aa2103aca4.md)文档中做出基本解释，故此处不再赘述。

</aside>

## 创建微调

该操作创建一个作业，从给定的数据集中微调指定的模型。

响应包括所排队的作业的详细信息，包括作业状态和完成后微调模型的名称。

详见[微调](%E5%BE%AE%E8%B0%83%201e63ab4b20b14f5fbf01c29815bd39a4.md)

```markdown
POST https://api.openai.com/v1/fine-tunes
```

### 参数

```markdown
training_file: string Required
包含训练数据的已上传文件的ID。
```

您的数据集必须以JSONL文件的格式进行格式化，每个训练示例都是一个JSON对象，其中包含键“prompt”和“completion”。

此外，您必须上传与目的微调相对应的文件（purpose == ”fine-tune”）。

```markdown
validation_file: string Optional
包含验证数据的已上传文件的ID。
```

在微调期间，请定期使用数据生成验证指标，以确保您提供的文件正确。

这些指标可以在微调结果文件中查看。

您的数据集必须以JSONL格式进行格式化，每个验证示例都是一个JSON对象，其中包含键“prompt”和“completion”。此外，您需要上传一个带有fine-tune目的的文件。

<aside>
⚠️ 为了确保有效性，您的训练和验证数据应该是互斥的。

</aside>

```markdown
model: string Optional Defaults: curie
微调的基础模型的名称。
```

选择其中之一："ada"，"babbage"，"curie"，"davinci"或在2022-04-21之后创建的微调模型。参考[模型](%E6%A8%A1%E5%9E%8B%20d5054199951a46c8b18dbd2073c3fa78.md)文档以及其中[微调](%E5%BE%AE%E8%B0%83%201e63ab4b20b14f5fbf01c29815bd39a4.md)关于继续微调“已微调”模型的相关部分

```markdown
n_epochs: integer Optional Defaults: 4
训练模型的时期数。
```

一个时期指的是完整地在训练数据集上进行一次循环。

```markdown
batch_size: integer Optional Defaults: null
训练时使用的批处理大小。
```

批处理大小是用于训练单个前向和后向传递的训练示例数量。

默认情况下，批处理大小将动态配置为训练集中示例数量的约0.2％，并限制为256个 - 通常，我们发现更大的批次大小对于较大的数据集效果更好。

```markdown
learning_rate_multiplier: number Optional Defaults: null
用于训练的学习率乘数。
```

微调学习率是原始预训练学习率乘以此值。

默认情况下，学习率乘数是0.05、0.1或0.2，取决于最终的批处理大小（较大的批处理大小通常使用较大的学习率）。尝试使用0.02到0.2范围内的值，以查看哪些值能够产生最好的结果。

```markdown
prompt_loss_weight: number Optional Defaults: 0.01
用于损失计算的提示标记的权重。
```

这控制着模型尝试学习生成提示的程度（相对于完成部分而言，完成部分始终具有1.0的权重），并且可以在完成部分较短时为训练添加稳定作用。

如果提示非常长（相对于完成部分而言），那么将这个权重降低可能有助于避免过度优先考虑学习提示/过分强调理解任务要求。

<aside>
⚠️ 过分强调理解任务要求（prompt）意味着花费过多的时间和精力来尝试理解和解释任务或作业的要求和指导。虽然理解任务要求的要求和期望很重要，但过度专注于它可能会削弱任务或作业的实际效果，最终作品可能会失去创造力和原创性。

</aside>

```markdown
compute_classification_metrics: boolean Optional Defaults: false
```

指定此参数后，在每个epoch结束时，我们将使用验证集计算特定于分类的度量指标，例如准确度和F1值，并将这些指标记录在结果文件中。

要计算分类指标，您需要提供一个验证文件，同时指定多类分类的分类n_classes或二元分类的classification_positive_class。

```markdown
classification_n_classes: integer Optional Defaults: null
分类任务中的类别数。
```

在多类别分类任务中，该参数是必需的。

```markdown
classification_positive_class: string Optional Defaults: null
二元分类中的正类。
```

在进行二分类任务时，需要此参数来生成精准率、召回率和F1指标。

```markdown
classification——betas: array Optional Defaults: null
此参数仅适用于二分类。
```

使用此参数，可以计算指定beta值下的F-beta指标。F-beta指标是F-1指标的一般化。beta为1（即F-1指标）时，精准率和召回率被赋予相同的权重。较大的beta值侧重于召回率而不是精准率，较小的beta值侧重于精准率而不是召回率。

```markdown
suffix: string Optional Defaults: null
一个长度最多为40个字符的字符串，它会被添加到微调后的模型名称中。
```

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/fine-tunes \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -d '{
    "training_file": "file-XGinujblHPwGLSztz8cPS8XY"
  }'
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.FineTune.create(training_file="file-XGinujblHPwGLSztz8cPS8XY")
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.createFineTune({
  training_file: "file-XGinujblHPwGLSztz8cPS8XY",
});
```

### 示例响应

```json
{
  "id": "ft-AF1WoRqd3aJAHsqc9NY7iL8F",
  "object": "fine-tune",
  "model": "curie",
  "created_at": 1614807352,
  "events": [
    {
      "object": "fine-tune-event",
      "created_at": 1614807352,
      "level": "info",
      "message": "Job enqueued. Waiting for jobs ahead to complete. Queue number: 0."
    }
  ],
  "fine_tuned_model": null,
  "hyperparams": {
    "batch_size": 4,
    "learning_rate_multiplier": 0.1,
    "n_epochs": 4,
    "prompt_loss_weight": 0.1,
  },
  "organization_id": "org-...",
  "result_files": [],
  "status": "pending",
  "validation_files": [],
  "training_files": [
    {
      "id": "file-XGinujblHPwGLSztz8cPS8XY",
      "object": "file",
      "bytes": 1547276,
      "created_at": 1610062281,
      "filename": "my-data-train.jsonl",
      "purpose": "fine-tune-train"
    }
  ],
  "updated_at": 1614807352,
}
```

## 列出微调

列出你的组织的微调作业。

```markdown
GET https://api.openai.com/v1/fine-tunes
```

### 参数

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/fine-tunes \
  -H "Authorization: Bearer $OPENAI_API_KEY"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.FineTune.list()
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.listFineTunes();
```

### 示例响应

```json
{
  "object": "list",
  "data": [
    {
      "id": "ft-AF1WoRqd3aJAHsqc9NY7iL8F",
      "object": "fine-tune",
      "model": "curie",
      "created_at": 1614807352,
      "fine_tuned_model": null,
      "hyperparams": { ... },
      "organization_id": "org-...",
      "result_files": [],
      "status": "pending",
      "validation_files": [],
      "training_files": [ { ... } ],
      "updated_at": 1614807352,
    },
    { ... },
    { ... }
  ]
}
```

## 检索微调

获取有关微调作业的信息。

```markdown
GET https://api.openai.com/v1/fine-tunes/{fine_tune_id}
```

### 参数

```json
fine_tune_id: string Required
微调作业的ID。
```

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/fine-tunes/ft-AF1WoRqd3aJAHsqc9NY7iL8F \
  -H "Authorization: Bearer $OPENAI_API_KEY"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.FineTune.retrieve(id="ft-AF1WoRqd3aJAHsqc9NY7iL8F")
```

### node.js

```jsx
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.FineTune.retrieve(id="ft-AF1WoRqd3aJAHsqc9NY7iL8F")
```

### 示例响应

```json
{
  "id": "ft-AF1WoRqd3aJAHsqc9NY7iL8F",
  "object": "fine-tune",
  "model": "curie",
  "created_at": 1614807352,
  "events": [
    {
      "object": "fine-tune-event",
      "created_at": 1614807352,
      "level": "info",
      "message": "Job enqueued. Waiting for jobs ahead to complete. Queue number: 0."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807356,
      "level": "info",
      "message": "Job started."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807861,
      "level": "info",
      "message": "Uploaded snapshot: curie:ft-acmeco-2021-03-03-21-44-20."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807864,
      "level": "info",
      "message": "Uploaded result files: file-QQm6ZpqdNwAaVC3aSz5sWwLT."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807864,
      "level": "info",
      "message": "Job succeeded."
    }
  ],
  "fine_tuned_model": "curie:ft-acmeco-2021-03-03-21-44-20",
  "hyperparams": {
    "batch_size": 4,
    "learning_rate_multiplier": 0.1,
    "n_epochs": 4,
    "prompt_loss_weight": 0.1,
  },
  "organization_id": "org-...",
  "result_files": [
    {
      "id": "file-QQm6ZpqdNwAaVC3aSz5sWwLT",
      "object": "file",
      "bytes": 81509,
      "created_at": 1614807863,
      "filename": "compiled_results.csv",
      "purpose": "fine-tune-results"
    }
  ],
  "status": "succeeded",
  "validation_files": [],
  "training_files": [
    {
      "id": "file-XGinujblHPwGLSztz8cPS8XY",
      "object": "file",
      "bytes": 1547276,
      "created_at": 1610062281,
      "filename": "my-data-train.jsonl",
      "purpose": "fine-tune-train"
    }
  ],
  "updated_at": 1614807865,
}
```

## 取消微调

```markdown
POST https://api.openai.com/v1/fine-tunes/{fine_tune_id}/cancel
```

### 参数

```json
fine_tune_id: string Required
要取消的微调作业的ID。
```

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/fine-tunes/ft-AF1WoRqd3aJAHsqc9NY7iL8F/cancel \
  -H "Authorization: Bearer $OPENAI_API_KEY"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.FineTune.cancel(id="ft-AF1WoRqd3aJAHsqc9NY7iL8F")
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.cancelFineTune("ft-AF1WoRqd3aJAHsqc9NY7iL8F");
```

### 示例响应

```json
{
  "id": "ft-xhrpBbvVUzYGo8oUO1FY4nI7",
  "object": "fine-tune",
  "model": "curie",
  "created_at": 1614807770,
  "events": [ { ... } ],
  "fine_tuned_model": null,
  "hyperparams": { ... },
  "organization_id": "org-...",
  "result_files": [],
  "status": "cancelled",
  "validation_files": [],
  "training_files": [
    {
      "id": "file-XGinujblHPwGLSztz8cPS8XY",
      "object": "file",
      "bytes": 1547276,
      "created_at": 1610062281,
      "filename": "my-data-train.jsonl",
      "purpose": "fine-tune-train"
    }
  ],
  "updated_at": 1614807789,
}
```

## 列出微调事件

<aside>
📖 Query parameters：查询参数，也称为URL参数、查询字符串或请求参数，查询参数是一种将数据传递到服务器的URL方法。 它们以问号 (?) 开始，并使用name=value的形式来组织数据，多个查询参数可以使用&符号分隔。

</aside>

```markdown
GET https://api.openai.com/v1/fine-tunes/{fine_tune_id}/events
```

### 参数

```markdown
fine_tune_id: string Required
要获取事件的微调作业的ID。
```

### URL查询参数

```markdown
stream: boolean Optional Defaults: false
```

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/fine-tunes/ft-AF1WoRqd3aJAHsqc9NY7iL8F/events \
  -H "Authorization: Bearer $OPENAI_API_KEY"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.FineTune.list_events(id="ft-AF1WoRqd3aJAHsqc9NY7iL8F")
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.listFineTuneEvents("ft-AF1WoRqd3aJAHsqc9NY7iL8F");
```

### **query parameter**

```markdown
##stream = true
https://api.openai.com/v1/fine-tunes/{fine_tune_id}/events?stream=true
##stream = false
https://api.openai.com/v1/fine-tunes/{fine_tune_id}/events?stream=false
```

### 示例响应

```json
{
  "object": "list",
  "data": [
    {
      "object": "fine-tune-event",
      "created_at": 1614807352,
      "level": "info",
      "message": "Job enqueued. Waiting for jobs ahead to complete. Queue number: 0."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807356,
      "level": "info",
      "message": "Job started."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807861,
      "level": "info",
      "message": "Uploaded snapshot: curie:ft-acmeco-2021-03-03-21-44-20."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807864,
      "level": "info",
      "message": "Uploaded result files: file-QQm6ZpqdNwAaVC3aSz5sWwLT."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807864,
      "level": "info",
      "message": "Job succeeded."
    }
  ]
}
```

## 删除微调模型

删除微调后的模型。

<aside>
⚠️ 必须在组织（Organization）中具有所有者（Owner）角色（Role）才可以进行删除操作。

</aside>

```markdown
DELETE https://api.openai.com/v1/models/{model}
```

### 参数

```markdown
model: string Required
需要删除的模型。
```

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/models/curie:ft-acmeco-2021-03-03-21-44-20 \
  -X DELETE \
  -H "Authorization: Bearer $OPENAI_API_KEY"
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Model.delete("curie:ft-acmeco-2021-03-03-21-44-20")
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.deleteModel('curie:ft-acmeco-2021-03-03-21-44-20');
```

### 示例响应

```json
{
  "id": "curie:ft-acmeco-2021-03-03-21-44-20",
  "object": "model",
  "deleted": true
}
```

# [内容审核](https://platform.openai.com/docs/api-reference/moderations)

<aside>
📖 **Moderation：**内容审核，在输出内容之前，请审核并处理文本，确保其符合OpenAI内容政策，不包含任何不良或敏感信息。如果输入文本违反了OpenAI内容政策，Moderation将会进行处理（中和、修改、拒绝等），以确保输出内容符合规范。

</aside>

接收输入文本，并确定模型是否将其归类为违反[OpenAI内容政策](OpenAI%20%E5%86%85%E5%AE%B9%E6%94%BF%E7%AD%96%2031e377528cfe49a9958830beb84c5883.md)的文本。

详细分类见[内容审核](%E5%86%85%E5%AE%B9%E5%AE%A1%E6%A0%B8%2033c5b656db41423db4271b57d822379c.md)

## 创建内容审核

对文本进行分类，确定其是否违反OpenAI内容政策。

```markdown
POST https://api.openai.com/v1/moderations
```

### 参数

```markdown
input: string | array Required
需要分类的输入文本。
```

```
model: string Optional Defaults: text-moderation-latest
有两个内容审查模型可供选择：text-moderation-stable和text-moderation-latest。
```

默认模型为text-moderation-latest，会自动升级以确保始终使用最准确的模型。text-moderation-stable的准确性可能略低于text-moderation-latest。

### 示例请求

### curl

```markdown
curl https://api.openai.com/v1/moderations \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -d '{
    "input": "I want to kill them."
  }'
```

### python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Moderation.create(
  input="I want to kill them.",
)
```

### node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.createModeration({
  input: "I want to kill them.",
});
```

### 示例响应

```json
{
  "id": "modr-5MWoLO",
  "model": "text-moderation-001",
  "results": [
    {
      "categories": {
        "hate": false,
        "hate/threatening": true,
        "self-harm": false,
        "sexual": false,
        "sexual/minors": false,
        "violence": true,
        "violence/graphic": false
      },
      "category_scores": {
        "hate": 0.22714105248451233,
        "hate/threatening": 0.4132447838783264,
        "self-harm": 0.005232391878962517,
        "sexual": 0.01407341007143259,
        "sexual/minors": 0.0038522258400917053,
        "violence": 0.9223177433013916,
        "violence/graphic": 0.036865197122097015
      },
      "flagged": true
    }
  ]
}
```

# [引擎](https://platform.openai.com/docs/api-reference/engines) Deprecated

<aside>
⚠️ 已废弃，请优先使用”模型“而不是引擎

</aside>

## **列出**引擎

列出当前可用的（未进行微调的）模型，并提供有关每个模型的基本信息，如所有者和可用性。

```markdown
GET https://api.openai.com/v1/engines
```

### 参数

### 示例请求

curl

```markdown
curl https://api.openai.com/v1/engines \
  -H "Authorization: Bearer $OPENAI_API_KEY"
```

python

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Engine.list()
```

node.js

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.listEngines();
```

### 示例响应

```json
{
  "data": [
    {
      "id": "engine-id-0",
      "object": "engine",
      "owner": "organization-owner",
      "ready": true
    },
    {
      "id": "engine-id-2",
      "object": "engine",
      "owner": "organization-owner",
      "ready": true
    },
    {
      "id": "engine-id-3",
      "object": "engine",
      "owner": "openai",
      "ready": false
    },
  ],
  "object": "list"
}
```

## **获取模型**

```markdown
GET https://api.openai.com/v1/engines/{engine_id}
```

检索模型实例，提供有关模型的基本信息，例如所有者和权限设置。

### 参数

```markdown
engine_id: string Required
用于此请求的模型的ID
```

### 示例请求

<aside>
🤖 以”text-davinci-003”为例，可自由替换现有模型，详细名称请查阅[模型](%E6%A8%A1%E5%9E%8B%20d5054199951a46c8b18dbd2073c3fa78.md)文档

</aside>

### **curl**

```markdown
curl https://api.openai.com/v1/engines/text-davinci-003 \
  -H "Authorization: Bearer $OPENAI_API_KEY"
```

### **python**

```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
openai.Engine.retrieve("text-davinci-003")
```

### **node.js**

```jsx
const { Configuration, OpenAIApi } = require("openai");
const configuration = new Configuration({
  apiKey: process.env.OPENAI_API_KEY,
});
const openai = new OpenAIApi(configuration);
const response = await openai.retrieveEngine("text-davinci-003");
```

### 示例响应

```json
{
  "id": "text-davinci-003",
  "object": "engine",
  "owner": "openai",
  "ready": true
}
```